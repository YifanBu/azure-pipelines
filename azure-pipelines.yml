trigger:
  - main

pool:
  vmImage: 'ubuntu-latest'

variables:
  IMAGE_REGISTRY_CONNECTION: 'Docker Hub'
  IMAGE_REGISTRY: ''
  IMAGE_REPOSITORY: 'ivanbuau'
  TAG: '$(Build.BuildId)'

stages:
  - stage: BuildApp
    jobs: 
    - job: BuildPushImage
      steps:
      - task: Docker@2
        inputs:
          containerRegistry: '$(IMAGE_REGISTRY_CONNECTION)'
          repository: '$(IMAGE_REPOSITORY)'
          command: 'buildAndPush'
          Dockerfile: '**/Dockerfile'
          tags: '$(TAG)'